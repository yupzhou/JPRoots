<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>JPRoots - 日琉语之道</title>
    <meta name="description" content="日琉语综合知识站">
    <link rel="icon" type="image/png" sizes="100x100" href="assets/img/icon.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/Article-List.css">
    <link rel="stylesheet" href="assets/css/Footer-Basic.css">
    <link rel="stylesheet" href="assets/css/iframe.css">
    <link rel="stylesheet" href="assets/css/Navigation-Clean.css">
    <link rel="stylesheet" href="assets/css/Navigation-with-Search.css">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>

<body>
    <nav class="navbar navbar-light navbar-expand-md navigation-clean-search fixed-top" style="border-bottom: 1px solid rgb(0,123,255) ;">
        <div class="container"><a class="navbar-brand" href="index.html" style="text-shadow: 0px 0px;">JPRoots</a><button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-2"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div
                class="collapse navbar-collapse" id="navcol-2">
                <ul class="nav navbar-nav">
                    <li class="nav-item"><a class="nav-link text-center text-secondary" href="road.html">道</a></li>
                    <li class="nav-item"><a class="nav-link text-center text-secondary" href="accent.html">调</a></li>
                    <li class="nav-item"><a class="nav-link text-center text-secondary" href="kunyomi.html">训</a></li>
                    <li class="nav-item"><a class="nav-link text-center text-secondary" href="onyomi.html">音</a></li>
                    <li class="nav-item"><a class="nav-link text-center text-secondary" href="others.html">他</a></li>
                    <li class="nav-item"><a class="nav-link text-center text-secondary" href="table.html">表</a></li>
                    <li class="nav-item"><a class="nav-link text-center text-primary" href="JLVDB.html" style="border-width: 1px;border-style: solid;border-radius: 55px;">JLVDB&nbsp;<i class="fa fa-book"></i></a></li>
                </ul>
                <form class="form-inline mr-auto" target="_self">
                    <div class="form-group"><label for="search-field"></label></div>
                </form>
        </div></div>
    </nav>
    <div></div>
    <div class="card" style="padding: 30px;filter: blur(0px);">
        <div class="container">
                    <div class="row" style="margin-top: 50px;">

                        <div class="col-md-3 col-lg-2 col-xl-3 d-block d-md-block d-none" style="margin: 0px 15px 0px 15px;">
                            <div class="form-group"><label for="search-field""></label>
                              <!-- 将两个搜索框组合在一起 -->
        <div class="search-combo-container">
            <!-- 单词搜索框组合 -->
            <div class="search-field-combo">
        					<input type="search" id="searchInput" class="search-field" name="search"  placeholder="Search ..."  autocomplete="off"/>
        					<!-- 将搜索结果的容器设置为绝对定位，以解决显示问题 移除
        					<div id="searchResultsContainer">
        					  <div id="searchResults"></div>
        					</div>-->
        <button class="btn" type="button"  id="searchBtn"><i class="fa fa-search" style="color: rgb(0,123,255);"></i></button>
        <button class="btn btn-primary" type="button"  id="randomBtn"><i class="fa fa-random" style="color: rgb(255, 255, 255);"></i></button>
            </div>
            <!-- 词族搜索框组合 -->
            <div class="filter-combo">
		<!-- 新增的下拉框 - 修改为带搜索功能的结构 -->
		<div class="filter-container">
			<!-- 隐藏原生select保留数据绑定 -->
			<select id="wd_fFilter" style="display:none">
			  <option value="">词族选择 ...</option>
			</select>
			
			<!-- 修改为带搜索功能的下拉框 -->
            <div class="filter-input-container">
                <input type="text" id="wd_fSearchInput" placeholder="词族搜索 ..." autocomplete="off">
                <div class="dropdown-button" id="customSelectTrigger">
                    <span class="arrow">▼</span>
                </div>
            </div>
            <div class="custom-options" id="customDropdown"></div>
		  </div>
</div>
        </div>	
        </div>
                        </div>

                        <div class="col-md-8 col-lg-9 col-xl-8 header-container" style="margin: 0px 15px 0px 10px; padding: 10px;">
                            <h3 class="text-primary" style="font-weight:normal;">日琉语词汇参考数据库 [建设中]</h3><h5 class="text-primary" style="font-weight:normal; text-decoration:overline;"><em>Japonic Languages Vocabulary DataBase</em></h5>
                        </div>

        				<!-- 将获取词汇列表的 JavaScript 代码中的 ID 修改为 "wordList" -->
                        <div class="col-md-3 col-lg-2 col-xl-3" style="border-radius: 20px;border: 1px solid rgb(0,128,255);margin: 0px 15px 0px 15px; padding-top: 5px; background-color: white;">
        					<h5><center><i class="fa fa-book"></i> 词汇表</center></h5>
        					<div style="height: 400px; ">
        						<ul id="wordList" style="height: 390px; overflow-y: scroll; "></ul>
        					</div>
        				</div>
        								
                        <div class="col-md-8 col-lg-9 col-xl-8" style="border-radius: 20px;border: 1px solid rgb(0,128,255);margin: 0px 15px 0px 10px; padding-top: 7px; line-height: 1; background-color: white;">
        					<div id="wordInfo" style="height: 420px; overflow-y: scroll; ">
								<p style="line-height: 1;  margin-bottom: 0px;"><center style="color:#007BFF; font-size: 20px;">～小贴士～</center></p>
									<p style="line-height: 1.5; margin-top: -5px;margin-bottom: 10px;">日琉语词汇参考数据库（JLVDB）是收录了丰富的日琉语词汇的辞典，支持 ① 词汇表直接搜索（宽屏左侧/窄屏上侧）、② 全字段模糊搜索（左上角第一搜索框）、③ 词族选择/模糊搜索（左上角第二搜索框）、④ 随机搜索（左上角第一搜索框右侧蓝色按钮）。</p>
									<p style="line-height: 1.5; margin-bottom: 10px;">由于前三个功能共用同一个单词表位置，在功能上是互斥的。</p>
									<p style="line-height: 1.5; margin-bottom: 10px;">全字段模糊搜索间接实现了筛选功能，如搜索「与那国」可得到存在与那国语形式的词汇，搜索「2.5」可得到 2.5 调类的词汇。</p>
									<p style="line-height: 1.5; margin-bottom: 10px;">全字段模糊搜索是实时查询的。如需精确搜索，请使用正则表达式：</p>
										<ol style="line-height: 1.5; margin-bottom: 10px;" type="1">
										<li>普通模式（默认）：可通过星号（*）匹配任意字符。</li>
										<li>正则模式：通过双斜杠包裹内容（/.../）触发，支持正则表达式规则：</li>
										</ol>
										<ol style="line-height: 1.5; margin-bottom: 10px;" type="i">
										<li>点号（.）匹配任意单个字符。</li>
										<li>星号（*）匹配任意字符。</li>
										<li>问号（?）匹配前一个字符 0 次或 1 次。</li>
										<li>加号（+）匹配前一个字符 1 次或多次。</li>
										<li>字符集（[...]）匹配方括号内任意一个字符。</li>
										<li>起始锚点（^）匹配字符串开头。</li>
										<li>结束锚点（$）匹配字符串结尾。</li>
										</ol>
										<p style="line-height: 1.5; margin-bottom: 10px;">方言形态、琉球诸语形态部分，由于采用了较宽的音位表记，不宜视为严谨的语音记录。</p>
							</div>
        				</div>
					</div>
				</div>
				<p class="copyright" style="font-size: 13px;text-align: center;padding-top: 10px;color: rgb(170,170,170);">© 2023-2025 Nanasi 七梨子</p>
    </div>
	
	<script>

let customDropdown, selectedText, originalSelect;

// 初始化函数（全局可用）
function initCustomDropdown() {
  customDropdown = document.getElementById("customDropdown");
  selectedText = document.querySelector(".selected-text");
  originalSelect = document.getElementById("wd_fFilter");
  
  // 绑定点击事件
  document.getElementById("customSelectTrigger").addEventListener("click", toggleCustomDropdown);
}

// 交互函数（全局可用）
function toggleCustomDropdown() {
  const isOpen = customDropdown.style.display === "block";
  const trigger = document.getElementById("customSelectTrigger");
  
  // 更新箭头方向
  if (isOpen) {
    trigger.classList.remove('open');
  } else {
    trigger.classList.add('open');
  }

  document.querySelectorAll(".custom-options").forEach(d => {
    d.style.display = "none";
    d.parentElement.classList.remove("dropdown-open");
  });

  if (!isOpen) {
    customDropdown.style.display = "block";
    document.querySelector(".filter-container").classList.add("dropdown-open");
    
    // 设置下拉菜单位置
    positionDropdown();
    
    setTimeout(() => {
      document.addEventListener("click", closeIfOutside);
    });
  }
}

function positionDropdown() {
  const comboContainer = document.querySelector('.filter-input-container');
  const dropdown = document.getElementById('customDropdown');
    // 正常定位
    dropdown.style.position = 'absolute';
    dropdown.style.top = '100%';
    dropdown.style.left = '0';
    dropdown.style.width = '100%';
    dropdown.style.zIndex = '1000';
}

function closeCustomDropdown() {
  // 确保元素已初始化
  if (!customDropdown) return;
  customDropdown.style.display = "none";
  const container = document.querySelector(".filter-container");
  if (container) container.classList.remove("dropdown-open");
  document.removeEventListener("click", closeIfOutside);
  
  // 恢复箭头方向
  const trigger = document.getElementById("customSelectTrigger");
  trigger.classList.remove('open');
}

function closeIfOutside(e) {
  if (!e.target.closest(".filter-container")) {
    closeCustomDropdown();
  }
}

	  // 使用 Fetch API 加载 JLVDB.json 文件
	  fetch("JLVDB.json")
	    .then(response => response.json())
	    .then(data => {
			console.log("Loaded JLVDB.json:", data);
	      const wordData = data;
		      // 初始化自定义下拉
			  initCustomDropdown();
    populateCustomDropdown(wordData);
		  const searchResultsContainer = document.getElementById("searchResultsContainer");
	      const searchInput = document.getElementById("searchInput");
	      const searchBtn = document.getElementById("searchBtn");
	      const randomBtn = document.getElementById("randomBtn");
	      const searchResults = document.getElementById("searchResults");
	      const wordList = document.getElementById("wordList");
	      const wordInfo = document.getElementById("wordInfo");
	
	      // 生成词汇表
	      for (const wordInfo of wordData) {
	        const word = wordInfo.word;
	        const li = document.createElement("li");
	        li.textContent = word;
	        li.addEventListener("click", () => displayWordInfo(word));
	        wordList.appendChild(li);
	      }

		  //250330新增反查功能
		  const wd_fFilter = document.getElementById("wd_fFilter");

    // 获取所有唯一的 wd_f 值
    const uniquewd_f = [...new Set(wordData.map(item => item.wd_f))];
    // 填充下拉框
    uniquewd_f.forEach(wd_f => {
      if (wd_f && wd_f.trim() !== "") {
        const option = document.createElement("option");
        option.value = wd_f;
        option.textContent = wd_f;
        wd_fFilter.appendChild(option);
      }
    });

    // 生成词汇表
    function generateWordList(filteredData = wordData) {
      wordList.innerHTML = "";
      filteredData.forEach(item => {
        const word = item.word;
        const li = document.createElement("li");
        li.textContent = word;
        li.addEventListener("click", () => displayWordInfo(word));
        wordList.appendChild(li);
      });
    }
    generateWordList();

// 筛选功能
wd_fFilter.addEventListener("change", () => {
      const selectedwd_f = wd_fFilter.value;

		// 清空搜索框
  searchInput.value = '';

      if (selectedwd_f) {
        const filteredData = wordData.filter(item => item.wd_f === selectedwd_f);
        generateWordList(filteredData);
      } else {
        generateWordList();
      }
    });


// 独立的填充函数
function populateCustomDropdown(wordData) {
  if (!customDropdown) return;
  
  customDropdown.innerHTML = '';
  
  // 添加空选项
  const emptyOption = document.createElement("div");
  emptyOption.className = "custom-option";
  emptyOption.textContent = "词族选择 ...";
  emptyOption.onclick = () => {
    if (selectedText) selectedText.textContent = "词族选择 ...";
    if (originalSelect) {
      originalSelect.value = "";
      originalSelect.dispatchEvent(new Event("change"));
    }
    closeCustomDropdown();
  };
  customDropdown.appendChild(emptyOption);

  // 添加数据选项
  const uniquewd_f = [...new Set(wordData.map(item => item.wd_f))];
  uniquewd_f.forEach(wd_f => {
    if (wd_f && wd_f.trim() !== "") {
      const option = document.createElement("div");
      option.className = "custom-option";
      option.textContent = wd_f;
      option.onclick = () => {
        if (selectedText) selectedText.textContent = wd_f;
        if (originalSelect) {
          originalSelect.value = wd_f;
          originalSelect.dispatchEvent(new Event("change"));
        }
        closeCustomDropdown();
      };
      customDropdown.appendChild(option);
    }
  });
}

// 添加词族搜索功能
const wd_fSearchInput = document.getElementById("wd_fSearchInput");
wd_fSearchInput.addEventListener("input", function() {
    const searchTerm = this.value.toLowerCase();
    const options = customDropdown.querySelectorAll(".custom-option");
    
    // 自动打开下拉菜单
    if (customDropdown.style.display !== "block") {
        toggleCustomDropdown();
    }
    
    // 原有过滤逻辑
    if (searchTerm === '') {
        options.forEach(option => option.style.display = "block");
        return;
    }
    
    options.forEach(option => {
        const text = option.textContent.toLowerCase();
        option.style.display = text.includes(searchTerm) ? "block" : "none";
    });
});

// 按下回车键选择第一个匹配项
wd_fSearchInput.addEventListener("keypress", function(e) {
    if (e.key === "Enter") {
        const searchTerm = this.value.toLowerCase();
        const options = customDropdown.querySelectorAll(".custom-option");
        let found = false;
        
        // 寻找第一个可见的选项
        for (const option of options) {
            if (option.style.display !== 'none') {
                option.click(); // 模拟点击选择
                found = true;
                break;
            }
        }
        
        // 如果没有找到，则恢复显示所有选项
        if (!found && options.length > 0) {
            options[0].click();
        }
    }
});

//250330新增反查功能

	      // 搜索功能
		  // 点击搜索按钮时显示词语列表
	      searchBtn.addEventListener("click", () => {
			  searchWord();
			  searchResultsContainer.style.display = "block";
			});
			// 按下回车键时显示词语列表
	      searchInput.addEventListener("keypress", (event) => {
	        if (event.key === "Enter") {
	          searchWord();
			  searchResultsContainer.style.display = "block";
	        }
	      });
		  
		  // 点击搜索框时不显示词语列表
		  searchInput.addEventListener("click", () => {
		    searchResultsContainer.style.display = "none";
		  });
	
	      // 随机搜索功能
	      randomBtn.addEventListener("click", () => randomSearchWord());

//250811通配符和多字段搜索

	      function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

function searchWord() {
    //const searchInput = document.getElementById("searchInput");
    let searchTerm = searchInput.value.trim();
    
    if (searchTerm === '') {
    generateWordList(wordData);
    wd_fFilter.value = ''; // 重置词族选择
    return;
  }
    
    // 检查用户是否主动使用正则表达式（以/开头和结尾）
    let regex;
    if (searchTerm.startsWith('/') && searchTerm.endsWith('/')) {
        try {
            // 提取正则表达式内容（忽略首尾的/）
            regex = new RegExp(searchTerm.slice(1, -1), 'i');
        } catch (e) {
            return;
        }
    } else {
        // 普通搜索模式：转义所有正则特殊字符，支持*和?作为通配符
        const escapedTerm = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        // 将输入的*替换为.*
        const pattern = escapedTerm.replace(/\*/g, '.*');
        regex = new RegExp(pattern, 'i');
    }
    
    const matchingWords = wordData.filter(item => {
        for (const key in item) {
            if (item.hasOwnProperty(key)) {
                const value = String(item[key] || ''); // 确保值为字符串
                if (regex.test(value)) {
                    return true;
                }
            }
        }
        return false;
    });
    
    //displaySearchResults(matchingWords);

	// 直接更新词汇表
  generateWordList(matchingWords);
  wd_fFilter.value = ''; // 重置词族选择
}

//250811通配符和多字段搜索
	
	      function randomSearchWord() {
	        const randomWord = wordData[Math.floor(Math.random() * wordData.length)].word;
	        displayWordInfo(randomWord);
	      }
		//生成匹配词汇列表
	      function displaySearchResults(matchingWords) {
	        searchResults.innerHTML = ""; // 清空之前的搜索结果
	
	        matchingWords.forEach(item => {
	          const word = item.word;
	          const resultItem = document.createElement("div");
			  const wordText = document.createElement("span");
	          resultItem.textContent = word;
			  wordText.classList.add("word");
			      resultItem.appendChild(wordText);
			  
			      // 添加分割线
			      const separator = document.createElement("div");
			      separator.classList.add("separator2");
			      resultItem.appendChild(separator);
			  
	          resultItem.addEventListener("click", () => displayWordInfo(word));
	          searchResults.appendChild(resultItem);
	        });
	      }

// 250609 新增词根弹窗
// 加载词根数据
let rootData = [];
fetch("JPRoots.json")
    .then(response => response.json())
    .then(data => {
        rootData = data;
        console.log("Loaded JPRoots.json:", rootData);
    // 添加全局事件监听器（关闭按钮）
        document.querySelector('.root-close-btn').addEventListener('click', closeRootModal);
        document.getElementById('root-info-modal').addEventListener('click', function(event) {
            if (event.target === this) closeRootModal();
        });
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') closeRootModal();
        });
    })
    .catch(error => console.error("Failed to load JPRoots.json:", error));

// 显示词根信息函数
function showRootInfo(rootName) {
    const rootInfo = rootData.find(item => item.root === rootName);
    if (rootInfo) {
        document.getElementById('root-name').textContent = rootInfo.root;
        
        let detailsHTML = '';
        if (rootInfo.PJR) detailsHTML += `<p class="root-detail"><strong>日琉祖语</strong> ${rootInfo.PJR}</p>`;
        if (rootInfo.POJ) detailsHTML += `<p class="root-detail"><strong>表日祖语</strong> ${rootInfo.POJ}</p>`;
        if (rootInfo.PR) detailsHTML += `<p class="root-detail"><strong>琉球祖语</strong> ${rootInfo.PR}</p>`;
        if (rootInfo.accent) detailsHTML += `<p class="root-detail"><strong>音　　调</strong> ${rootInfo.accent}</p>`;
        if (rootInfo.pos) detailsHTML += `<p class="root-detail"><strong>词　　性</strong> ${rootInfo.pos}</p>`;
        if (rootInfo.meaning) detailsHTML += `<p class="root-detail"><strong>含　　义</strong> ${rootInfo.meaning}</p>`;
        
        document.getElementById('root-details').innerHTML = detailsHTML;
        document.getElementById('root-info-modal').style.display = 'flex';
    } else {
        alert(`未找到词根“${rootName}”的信息`);
    }
}

// 关闭词根弹窗
function closeRootModal() {
    document.getElementById('root-info-modal').style.display = 'none';
}

//250609 新增词根弹窗

//250825新增内容
//添加输入监听
searchInput.addEventListener("input", () => {
  if (searchInput.value === '') {
    generateWordList(wordData);
    wd_fFilter.value = '';
  } else {
    searchWord();
  }
});

//添加防抖处理
let searchTimeout;
searchInput.addEventListener("input", () => {
  clearTimeout(searchTimeout);
  searchTimeout = setTimeout(() => {
    if (searchInput.value === '') {
      generateWordList(wordData);
      wd_fFilter.value = '';
    } else {
      searchWord();
    }
  }, 300);
});


//250825新增内容

	      // 显示词语的信息
	      function displayWordInfo(word) {
	       
			const info = wordData.find(item => item.word === word);
			  let infoHTML = `<h3>${word}</h3>`;
			  infoHTML += `<div class="separator"></div>`;
			  infoHTML += `<p><strong class="underlined-text">基 本 信 息</strong></p>`;
			  if (info.hb && info.hb.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">变体平文</strong> ${info.hb}</p>`;
			  }
			  if (info.kz && info.kz.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">汉字</strong> ${info.kz}</p>`;
			  }
			  if (info.wd_c && info.wd_c.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">词性</strong> ${info.wd_c}</p>`;
			  }
			  if (info.ky && info.ky.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">活用</strong> ${info.ky}</p>`;
			  }
			  if (info.ac && info.ac.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">音调</strong> ${info.ac}</p>`;
			  }
			  if (info.mn && info.mn.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">释义</strong> ${info.mn}</p>`;
			  }
              if (info.class2 && info.class2.trim() !== "0") {
			    infoHTML += `<p><strong class="underlined-text">历 史 音 韵 学</strong></p>`;
			  }
			  if (info.preoj && info.preoj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">上代以前</strong> ${info.preoj}</p>`;
			  }
			  if (info.pij && info.pij.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">上代半岛</strong> ${info.pij}</p>`;
			  }
			  if (info.woj && info.woj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">上代中央</strong> ${info.woj}</p>`;
			  }
			  if (info.aoj && info.aoj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">上代东国</strong> ${info.aoj}</p>`;
			  }
			  if (info.ooj && info.ooj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">上代其他</strong> ${info.ooj}</p>`;
			  }
			  if (info.emj && info.emj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">中古</strong> ${info.emj}</p>`;
			  }
			  if (info.lmj && info.lmj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">中世</strong> ${info.lmj}</p>`;
			  }
			  if (info.mdj && info.mdj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">近世现代</strong> ${info.mdj}</p>`;
			  }
			  if (info.hkz && info.hkz.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">历史假名</strong> ${info.hkz}</p>`;
			  }
			  if (info.mkz && info.mkz.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">现代假名</strong> ${info.mkz}</p>`;
			  }
			  if (info.class3 && info.class3.trim() !== "0") {
			    infoHTML += `<p><strong class="underlined-text">本 土 方 言 形 态</strong></p>`;
			  }
			  if (info.ej && info.ej.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">东部日本</strong> ${info.ej}</p>`;
			  }
			  if (info.wj && info.wj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">西部日本</strong> ${info.wj}</p>`;
			  }
			  if (info.itj && info.itj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text">出云|东北</strong> ${info.itj}</p>`;
			  }
			  if (info.kj && info.kj.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">九州方言</strong> ${info.kj}</p>`;
			  }
			  if (info.class4 && info.class4.trim() !== "0") {
			    infoHTML += `<p><strong class="underlined-text">琉 球 诸 语 形 态</strong></p>`;
			  }
			  if (info.am && info.am.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">奄美诸语</strong> ${info.am}</p>`;
			  }
			  if (info.ok && info.ok.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">冲绳诸语</strong> ${info.ok}</p>`;
			  }
			  if (info.mi && info.mi.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">宫古诸语</strong> ${info.mi}</p>`;
			  }
			  if (info.ya && info.ya.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">大八重山</strong> ${info.ya}</p>`;
			  }
			  if (info.class5 && info.class5.trim() !== "0") {
			    infoHTML += `<p><strong class="underlined-text">词 源 学</strong></p>`;
			  }
			  if (info.lg_c && info.lg_c.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">语言集合</strong> ${info.lg_c}</p>`;
			  }
			  // 修改词根（词族）显示为可点击链接
    if (info.wd_f && info.wd_f.trim() !== "") {
        infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;">
            <strong class="bordered-text justify-text">词族</strong> 
            <span class="root-link" data-root="${info.wd_f}">${info.wd_f}</span>
        </p>`;
    }
	if (info.cp && info.cp.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">复合</strong> ${info.cp}</p>`;
			  }
			  if (info.da && info.da.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">分解</strong> ${info.da}</p>`;
			  }
			  if (info.pr && info.pr.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">琉球祖语</strong> ${info.pr}</p>`;
			  }
			  if (info.pjr && info.pjr.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">日琉祖语</strong> ${info.pjr}</p>`;
			  }
			  if (info.pf && info.pf.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">前缀</strong> ${info.pf}</p>`;
			  }
			  if (info.sf && info.sf.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">后缀</strong> ${info.sf}</p>`;
			  }
			  if (info.uc && info.uc.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text">ＵniＣog</strong> ${info.uc}</p>`;
			  }
			  if (info.class6 && info.class6.trim() !== "0") {
			    infoHTML += `<p><strong class="underlined-text">比 较 语 言 学</strong></p>`;
			  }
			  if (info.ai && info.ai.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">Ａｉｎｕ</strong> ${info.ai}</p>`;
			  }
			  if (info.ko && info.ko.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">朝鲜</strong> ${info.ko}</p>`;
			  }
			  if (info.st && info.st.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">汉藏</strong> ${info.st}</p>`;
			  }
			  if (info.as && info.as.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">南岛</strong> ${info.as}</p>`;
			  }
			  if (info.kt && info.kt.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">侗台</strong> ${info.kt}</p>`;
			  }
			  if (info.ie && info.ie.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">印欧</strong> ${info.ie}</p>`;
			  }
			  if (info.te && info.te.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">突蒙满通</strong> ${info.te}</p>`;
			  }
			  if (info.ol && info.ol.trim() !== "") {
			    infoHTML += `<p style="line-height: 1.5; margin: 0 0 10px;"><strong class="bordered-text justify-text">其他</strong> ${info.ol}</p>`;
			  }
			  wordInfo.innerHTML = infoHTML;
	

			  //250609 新增词根弹窗
// 为新创建的元素添加事件监听
    document.querySelectorAll('.root-link').forEach(link => {
        link.addEventListener('click', function() {
            showRootInfo(this.dataset.root);
        });
    });
			  //250609 新增词根弹窗


	      }
		  
		  // 监听整个文档的点击事件
		    document.addEventListener("click", (event) => {
		      // 检查点击的元素是否在搜索结果的容器内或搜索输入框上，如果在则保持显示词语列表
		      if (searchResultsContainer.contains(event.target)) {
		        searchResultsContainer.style.display = "block"; // 确保词语列表显示
		      } else {
		        searchResultsContainer.style.display = "none"; // 否则，隐藏词语列表
		      }
		    });
		  
		  // 点击搜索按钮时不隐藏词汇列表
		  searchBtn.addEventListener("click", (event) => {
		    event.stopPropagation(); // 阻止事件传播，防止文档点击事件的处理程序执行
		    searchWord(); // 执行搜索功能
		    searchResultsContainer.style.display = "block"; // 确保词语列表显示
		  });
		  
	    })
	    .catch(error => console.error("Failed to load JLVDB.json:", error));


	</script>
	
	<style>
	  #searchResultsContainer {
	    position: absolute;
	    z-index: 1;
	    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* 添加阴影效果 */
		background-color: white;
		width: 160px;
		overflow-y: auto; /* 添加纵向滚动条，当内容超过容器高度时显示滚动条 */
		display: none;
		height: 100px;
	  }
	
		#wordList {
		    list-style-type: none; /* 去掉圆点 */
			padding: 0; /* 移除默认的列表项内边距 */
			font-size: 15px;
		  }
		
		#wordList li::before {
		  content: "»"; /* 添加自定义的符号作为列表项的标记 */
		  margin-right: 5px; /* 可选：增加一些空间，使汉字与列表项内容之间有一定距离 */
		  padding: 3px;
		}
		
		  #wordList li {
		    border-bottom: 1px solid #ccc; /* 使用边框分隔词汇 */
		    padding: 3px;
			margin: 0px 10px 0px 0px;
		  }
		
		.separator {
		  border-top: 1px solid #007bff; /* 添加上边框作为分割线，可以根据需要调整颜色和粗细 */
		  margin: 5px 10px 12px 0px; /* 调整分割线与其他内容的间距，根据需要调整值 */
		}
			
		/* 词汇文本的样式 */
		div#searchResults {
		  font-size: 14px;
		  padding: 3px;
		  margin: 0px 10px 0px 10px;
		}
		
		/* 分割线样式 */
		.separator2 {
		  border-top: 1px solid #ccc; /* 添加上边框作为分割线，可以根据需要调整颜色和粗细 */
		margin: 2px 0;
		}
		
		.header-container{
			display: flex;
			flex-direction: column;
			justify-content: space-evenly;
			text-align: center;
		}

/* 自定义下拉样式 */
.filter-container {
  position: relative;
  width: 97%;
}

.custom-select {
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 8px 12px 8px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: white;
  margin-top: 5px;
}

.custom-options {
  position: absolute;
  width: 100%;
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid #ddd;
  background: white;
  display: none;
  z-index: 1000;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.custom-option {
  padding: 4px 6px;
  border-bottom: 1px solid #f5f5f5;
  cursor: pointer;
  font-size: 14px;
  border-top: 1px solid #ccc; /* 添加上边框作为分割线，可以根据需要调整颜色和粗细 */
	margin: 0px 5px;
}

.custom-option:hover {
  background: #f8f9fa;
}

.arrow {
  transition: transform 0.2s;
  font-size: 12px;
  color: #007bff;
}

.dropdown-open .arrow {
  transform: rotate(180deg);
}

strong.bordered-text {
    border: 3px solid #007bff; 
    border-radius: 10px; 
    padding: 1px 4px 2px 4px; 
    margin: 0 5px 0 0; 
	font-size: 14px;
	color: #007bff;
}

strong.underlined-text{
	color: #007bff;
	line-height: 1.5; 
	margin: 0px 0 10px;
	padding-bottom: 3px;
	font-size: 18px;
	border-bottom: 3px solid #ff67c0;
}

/* 250609 新增词根弹窗 */

/* 词根弹窗样式 */
    .root-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2000;
        align-items: center;
        justify-content: center;
    }
    
    .root-modal-content {
        background-color: white;
        border-radius: 15px;
        padding: 20px;
        width: 75%;
        max-width: 300px;
        box-shadow: 0 5px 25px rgba(0,0,0,0.3);
        position: relative;
        border: 1px solid #007bff;
        animation: popIn 0.3s;
		background-color: rgba(255, 255, 255, 0.5); /* 半透明 */
		backdrop-filter: blur(15px); /* 模糊 */
    }
    
    @keyframes popIn {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
    }
    
    .root-close-btn {
        position: absolute;
        top: 12px;
        right: 20px;
        font-size: 28px;
        cursor: pointer;
        color: #777;
    }
    
    .root-close-btn:hover {
        color: #007bff;
    }
    
    #root-name {
        color: #333;
        margin-top: 0;
		margin-bottom: 15px;
        font-size: 24px;
        border-bottom: 1px solid #007bff;
        padding-bottom: 10px;
    }
    
    .root-detail {
        margin: 10px 0;
        line-height: 1.6;
    }
    
    .root-detail strong {
        border: 3px solid #007bff; 
    border-radius: 10px; 
    padding: 1px 4px 2px 4px; 
    margin: 0 5px 0 0; 
	font-size: 14px;
	color: #007bff;
    }
    
    /* 词根链接样式 */
    .root-link {
        color: #007bff;
        cursor: pointer;
        text-decoration:none;
        font-weight: bold;
        transition: all 0.2s;
        padding: 2px 4px;
        border-radius: 4px;
    }
    
    .root-link:hover {
        background-color: rgba(0, 123, 255, 0.1);
        text-decoration: none;
    }


/* 250609 新增词根弹窗 */

/* 两个框响应式设计 */

  input#searchInput.search-field {
	height: 35px;
	margin-bottom: 10px;
	border-width: 1px;
	border-style: none;
	border-bottom-style: solid;
	color: rgb(150,150,150);
	font-size: 14px; 
	padding-left: 12px;
  }

  button#searchBtn.btn{
	font-size: 14px;
	margin-bottom: 6px;
  }   

button#randomBtn.btn.btn-primary {
	height: 37px;
	width: 40px;
  margin-right: 3%;
	font-size: 14px;
	margin-bottom: 6px;
	padding-bottom: 30px;
  }

@media screen and (max-width: 768px) {
  button#searchBtn.btn{
	width: 10%;
  }
}

@media screen and (min-width: 768px) and (max-width: 1200px) {
  button#searchBtn.btn{
	width: 10%;
  margin-left: 5%;
  margin-right: 5%;
  }    
  button#randomBtn.btn.btn-primary {
	margin-left: 2%;
  }

}

@media screen and (min-width: 1200px) {
  button#searchBtn.btn{
	width: 15%;
  }    
  button#randomBtn.btn.btn-primary {
	margin-left: 2%;
  }

}

#randomBtn, #searchBtn {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 0 !important;
}

#randomBtn .fa-random, #searchBtn .fa-search {
        margin: 0 !important;                /* 移除图标边距 */
    font-size: 16px;                     /* 调整图标大小 */
    display: block !important;            /* 确保图标是块级元素 */
    line-height: 1;
}

/* 新增词族搜索框 */
        .filter-input-container {
            display: flex;
            gap: 5px;
            margin-bottom: -5px;
        }
        @media screen and (min-width: 1200px) {
        #wd_fSearchInput {
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 8px 12px;
            outline: none;
            font-size: 14px;
        }}

		@media screen and (min-width: 768px) and (max-width: 1200px) {
        #wd_fSearchInput {
			width: 70px;
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 8px 12px;
            outline: none;
            font-size: 14px;
        }}
        
		@media screen and (max-width: 768px){
			#wd_fSearchInput {
        width: 30%;
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 8px 12px;
            outline: none;
            font-size: 14px;
        }}


        .dropdown-button {
            width: 40px;
            padding: 0 12px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .dropdown-button:hover {
            background: #e9ecef;
        }
        
        .dropdown-button.open .arrow {
            transform: rotate(180deg);
        }
        
        .arrow {
            font-size: 12px;
            color: #007BFF;
            transition: transform 0.3s ease;
        }
        
/* 两个搜索框对齐 */

.search-combo-container {
  display: flex;
  flex-direction: column;
}

.search-field-combo {
  margin-top: -10px;
  display: flex;
  width: 100%;
}

.search-field {
  flex-grow: 1; /* 填充剩余空间 */
  min-width: 0; /* 防止内容溢出 */
}

.search-field:focus {
    outline: none; /* 移除默认轮廓 */
    border-color: #007BFF; /* 设置新的边框颜色 */
}

#wd_fSearchInput:focus {
    outline: none; /* 移除默认轮廓 */
    border-color: #007BFF; /* 设置新的边框颜色 */
}

.btn, .btn-primary {
  width: 100px; /* 固定宽度 */
  flex-shrink: 0; /* 禁止收缩 */
}

.filter-combo {
  width: 100%;
}

#searchInput::placeholder {
    font-style: italic;
    font-size: 16px;
}

.justify-text {
    display: inline-block;
    width: 5em;
    text-align: justify; /* 普通对齐 */
    text-align-last: justify; /* 最后一行对齐 */
    -moz-text-align-last: justify; /* Firefox 支持 */
    overflow: hidden;
    vertical-align: middle;
    font-size: calc(5em / var(--char-count, 4));
    word-break: break-all; /* 强制所有字符都参与分散对齐 */
    letter-spacing: 0; /* 重置字母间距 */
    word-spacing: 0; /* 重置单词间距 */
    text-justify: inter-character; /* 使用字符间距调整 */
}

	</style>

	<!--250609 新增词根弹窗-->
	<!-- 词根弹窗 -->
<div id="root-info-modal" class="root-modal">
    <div class="root-modal-content">
        <span class="root-close-btn">&times;</span>
        <h3 id="root-name"></h3>
        <div id="root-details"></div>
    </div>
</div>
<!--250609 新增词根弹窗-->

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
	<script src="assets/js/accent_sta.js"></script>
    <script src="assets/js/cont.js"></script>
    <script src="assets/js/index_sta.js"></script>
    <script src="assets/js/JLVDB_sta.js"></script>
    <script src="assets/js/kunyomi_sta.js"></script>
    <script src="assets/js/onyomi_sta.js"></script>
    <script src="assets/js/others_sta.js"></script>
    <script src="assets/js/road_sta.js"></script>
</body>

</html>